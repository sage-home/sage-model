CC       = gcc

# Set compiler flags (removed OpenMP)
CFLAGS   = -g -Wall -Wextra -std=c99 -I../src

# Set linker flags (removed OpenMP)
LDFLAGS  = -lm

# Source and header directories
SAGE_SRC = ../src

# Create simpler test version with fewer dependencies
# Set up minimal test to directly test the output preparation module
test_output_preparation_simple: test_output_preparation_simple.c 
	$(CC) $(CFLAGS) -o $@ $^ $(LDFLAGS)

# Simple test for output preparation module
test_output_preparation_simple.c: test_output_preparation.c
	cp test_output_preparation.c test_output_preparation_simple.c
	sed -i '' 's/module_system_initialize();/\/\/ module_system_initialize();/g' test_output_preparation_simple.c
	sed -i '' 's/pipeline_system_initialize();/\/\/ pipeline_system_initialize();/g' test_output_preparation_simple.c
	sed -i '' 's/pipeline_system_cleanup();/\/\/ pipeline_system_cleanup();/g' test_output_preparation_simple.c
	sed -i '' 's/module_system_cleanup();/\/\/ module_system_cleanup();/g' test_output_preparation_simple.c
	sed -i '' 's/init_output_preparation_module();/\/\/ init_output_preparation_module();/g' test_output_preparation_simple.c
	sed -i '' 's/cleanup_output_preparation_module();/\/\/ cleanup_output_preparation_module();/g' test_output_preparation_simple.c

clean:
	rm -f test_output_preparation test_output_preparation_simple test_output_preparation_simple.c

.PHONY: all clean