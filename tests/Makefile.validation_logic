# Test makefile for module validation logic
CC := clang
CFLAGS := -g -Wall -I../src -I../src/core
LDFLAGS := -lm

# Platform detection for linker flags
UNAME := $(shell uname)
ifeq ($(UNAME), Linux)
    LDFLAGS += -ldl
endif

# Test programs
TEST_VALIDATION_LOGIC := test_validation_logic

all: $(TEST_VALIDATION_LOGIC)

$(TEST_VALIDATION_LOGIC): test_validation_logic.c test_invalid_module.c
	$(CC) $(CFLAGS) -o $@ $^ -L.. -lsage $(LDFLAGS)

clean:
	rm -f $(TEST_VALIDATION_LOGIC)
	rm -rf test_validation_output