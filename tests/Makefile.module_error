# Makefile for module error handling system tests

TEST_NAME := test_module_error
TEST_SRC := test_module_error.c
TEST_OBJS := test_module_error.o

SAGE_LIB_DIR := ..
SAGE_LIB := sage

CC := clang
INCLUDES := -I../src
LIBS := -L$(SAGE_LIB_DIR) -l$(SAGE_LIB) -lm

# Compiler flags
CFLAGS := -g -O0 -Wall -Wextra -Werror
LDFLAGS := -g

# Default target
all: $(TEST_NAME)

# Link the test executable
$(TEST_NAME): $(TEST_OBJS)
	$(CC) $(LDFLAGS) -o $@ $^ $(LIBS)

# Compile test source
%.o: %.c
	$(CC) $(CFLAGS) $(INCLUDES) -c $< -o $@

# Run the test
run: $(TEST_NAME)
	./$(TEST_NAME)

# Clean up
clean:
	rm -f $(TEST_OBJS) $(TEST_NAME)

.PHONY: all run clean