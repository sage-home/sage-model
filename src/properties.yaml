# properties.yaml - Central property definition for SAGE
# This file defines all galaxy properties used by physics modules
#
# Required fields:
#   name: Property name (used in accessor macros)
#   type: Data type (int32_t, float, double, arrays, etc.)
#   initial_value: Default value when initializing
#   units: Physical units of the property
#   description: Human-readable description
#   output: Boolean flag for whether to include in output files
#   read_only: Property access control (false, true, "after_first_set")
#   is_core: Boolean flag indicating if property is a core property (default: false)
#     IMPORTANT: Properties that match core_properties.yaml must have is_core: true
#
# Dynamic array syntax:
#   type: float[] - Empty brackets indicate dynamic size
#   size_parameter: "parameter_name" - Name of runtime parameter determining size

properties:
  # Identification Properties
  - name: SnapNum
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "Snapshot number of the galaxy"
    output: true
    read_only: false
    is_core: true

  - name: Type
    type: int32_t
    initial_value: 0
    units: "dimensionless"
    description: "Galaxy type (0=central, 1=satellite)"
    output: true
    read_only: false
    is_core: true

  - name: GalaxyNr
    type: int32_t
    initial_value: 0
    units: "dimensionless" 
    description: "Galaxy number within the tree"
    output: true
    read_only: false
    is_core: true
  
  - name: CentralGal
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "Index of the central galaxy in the same FoF group"
    output: true
    read_only: false
    is_core: true

  - name: HaloNr
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "Halo number in the tree"
    output: true
    read_only: false
    is_core: true
    
  - name: MostBoundID
    type: long long
    initial_value: -1
    units: "dimensionless"
    description: "ID of the most bound particle in the subhalo"
    output: true
    read_only: false
    is_core: true

  - name: GalaxyIndex
    type: uint64_t
    initial_value: 0
    units: "dimensionless"
    description: "Unique galaxy identifier based on tree local galaxy number, file local tree number and file number"
    output: true
    read_only: "after_first_set"
    is_core: true
    
  - name: CentralGalaxyIndex
    type: uint64_t
    initial_value: 0
    units: "dimensionless"
    description: "Galaxy index of the central galaxy of this galaxy's FoF group"
    output: true
    read_only: "after_first_set"
    is_core: true

  - name: SAGEHaloIndex
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "SAGE-specific halo identifier"
    output: true
    read_only: false
    is_core: true
    
  - name: SAGETreeIndex
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "SAGE-specific tree identifier"
    output: true
    read_only: false
    is_core: true
    
  - name: SimulationHaloIndex
    type: long long
    initial_value: -1
    units: "dimensionless"
    description: "Original simulation halo index"
    output: true
    read_only: false
    is_core: true

  - name: merged
    type: int32_t
    initial_value: 0
    units: "dimensionless"
    description: "Galaxy merger status (0=active, 1=merged/removed)"
    output: false
    read_only: false
    is_core: true

  # Merger Properties - Physics Module Properties
  - name: MergTime
    type: float
    initial_value: 999.9
    units: "Gyr"
    description: "Time until merger"
    output: true
    read_only: false
    is_core: false
    required_modules: ["mergers"]

  - name: mergeType
    type: int32_t
    initial_value: 0
    units: "dimensionless"
    description: "Merger type (0=none; 1=minor merger; 2=major merger; 3=disk instability; 4=disrupt to ICS)"
    output: true
    read_only: false
    is_core: false
    required_modules: ["mergers"]

  - name: mergeIntoID
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "Galaxy ID that this galaxy merges into"
    output: true
    read_only: false
    is_core: false
    required_modules: ["mergers"]
    
  - name: mergeIntoSnapNum
    type: int32_t
    initial_value: -1
    units: "dimensionless"
    description: "Snapshot number when the merger occurs"
    output: true
    read_only: false
    is_core: false
    required_modules: ["mergers"]
    
  - name: dT
    type: float
    initial_value: 0.0
    units: "Gyr"
    description: "Time step for galaxy evolution"
    output: true
    read_only: false
    is_core: true
    
  # Halo Properties
  - name: Pos
    type: float[3]
    initial_value: [0.0, 0.0, 0.0]
    units: "Mpc/h"
    description: "Position coordinates (x,y,z)"
    output: true
    read_only: false
    is_core: true
    
  - name: Vel
    type: float[3]
    initial_value: [0.0, 0.0, 0.0]
    units: "km/s"
    description: "Velocity components (vx,vy,vz)"
    output: true
    read_only: false
    is_core: true

  - name: Spin
    type: float[3]
    initial_value: [0.0, 0.0, 0.0]
    units: "dimensionless"
    description: "Angular momentum vector (Jx,Jy,Jz)"
    output: true
    read_only: false
    is_core: true
    
  - name: Len
    type: int32_t
    initial_value: 0
    units: "dimensionless"
    description: "Number of particles in the halo"
    output: true
    read_only: false
    is_core: true
    
  - name: Mvir
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Virial mass of the halo"
    output: true
    read_only: false
    is_core: true
    
  - name: deltaMvir
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Change in virial mass since last snapshot"
    output: true
    read_only: false
    is_core: true
    
  - name: CentralMvir
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Virial mass of the central subhalo"
    output: true
    read_only: false
    is_core: true
    
  - name: Rvir
    type: float
    initial_value: 0.0
    units: "Mpc/h"
    description: "Virial radius"
    output: true
    read_only: false
    is_core: true
    
  - name: Vvir
    type: float
    initial_value: 0.0
    units: "km/s"
    description: "Virial velocity"
    output: true
    read_only: false
    is_core: true
    
  - name: Vmax
    type: float
    initial_value: 0.0
    units: "km/s"
    description: "Maximum circular velocity"
    output: true
    read_only: false
    is_core: true
    
  - name: VelDisp
    type: float
    initial_value: 0.0
    units: "km/s"
    description: "Velocity dispersion"
    output: true
    read_only: false
    is_core: true

  # Baryonic Components
  - name: ColdGas
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Cold gas mass in the disk"
    output: true
    read_only: false
    is_core: false
    required_modules: ["cooling", "starformation", "infall"]
    
  - name: StellarMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Total stellar mass (disk + bulge)"
    output: true
    read_only: false
    is_core: false
    required_modules: ["starformation"]
    
  - name: BulgeMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Stellar mass in the bulge"
    output: true
    read_only: false
    is_core: false
    
  - name: HotGas
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Hot gas mass in the halo"
    output: true
    read_only: false
    is_core: false
    
  - name: EjectedMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Gas mass ejected by feedback"
    output: true
    read_only: false
    is_core: false
    
  - name: BlackHoleMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Black hole mass"
    output: true
    read_only: false
    is_core: false
    
  - name: ICS
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Intracluster stars mass"
    output: true
    read_only: false
    is_core: false
    
  # Metals
  - name: MetalsColdGas
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Metal mass in cold gas"
    output: true
    read_only: false
    is_core: false
    
  - name: MetalsStellarMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Metal mass in stars"
    output: true
    read_only: false
    is_core: false
    
  - name: MetalsBulgeMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Metal mass in bulge"
    output: true
    read_only: false
    is_core: false
    
  - name: MetalsHotGas
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Metal mass in hot gas"
    output: true
    read_only: false
    is_core: false
    
  - name: MetalsEjectedMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Metal mass in ejected gas"
    output: true
    read_only: false
    is_core: false
    
  - name: MetalsICS
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Metal mass in intracluster stars"
    output: true
    read_only: false
    is_core: false
    
  # Star Formation History - Fixed Arrays
  - name: SfrDisk
    type: float[STEPS]
    initial_value: 0.0
    units: "Msun/yr"
    description: "Star formation rate in disk for each timestep"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "derive_output_SfrDisk"
    
  - name: SfrBulge
    type: float[STEPS]
    initial_value: 0.0
    units: "Msun/yr"
    description: "Star formation rate in bulge for each timestep"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "derive_output_SfrBulge"
    
  - name: SfrDiskColdGas
    type: float[STEPS]
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Cold gas mass during disk star formation for each timestep"
    output: true
    read_only: false
    is_core: false
    
  - name: SfrDiskColdGasMetals
    type: float[STEPS]
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Cold gas metals during disk star formation for each timestep"
    output: true
    read_only: false
    is_core: false
    
  - name: SfrBulgeColdGas
    type: float[STEPS]
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Cold gas mass during bulge star formation for each timestep"
    output: true
    read_only: false
    is_core: false
    
  - name: SfrBulgeColdGasMetals
    type: float[STEPS]
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Cold gas metals during bulge star formation for each timestep"
    output: true
    read_only: false
    is_core: false
    
  # Example of Dynamic Array Property
  - name: StarFormationHistory
    type: float[]
    size_parameter: "simulation.NumSnapOutputs"
    initial_value: 0.0
    units: "Msun/yr"
    description: "Complete star formation history for all output snapshots"
    output: true
    read_only: false
    is_core: false
    required_modules: ["starformation"]
    
  # Structural Properties
  - name: DiskScaleRadius
    type: float
    initial_value: 0.0
    units: "Mpc/h"
    description: "Scale radius of the stellar disk"
    output: true
    read_only: false
    is_core: false
    
  # Cooling & Heating
  - name: Cooling
    type: double
    initial_value: 0.0
    units: "erg/s"
    description: "Cooling energy rate"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "transform_output_Cooling"
    
  - name: Heating
    type: double
    initial_value: 0.0
    units: "erg/s"
    description: "Heating energy rate (from AGN)"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "transform_output_Heating"
    
  - name: r_heat
    type: float
    initial_value: 0.0
    units: "Mpc/h"
    description: "Heating radius for AGN feedback"
    output: true
    read_only: false
    is_core: false
    
  - name: QuasarModeBHaccretionMass
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Mass accreted by black hole in quasar mode"
    output: true
    read_only: false
    is_core: false
    
  # History
  - name: TimeOfLastMajorMerger
    type: float
    initial_value: 0.0
    units: "Gyr"
    description: "Time of last major merger"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "transform_output_TimeOfLastMajorMerger"
    
  - name: TimeOfLastMinorMerger
    type: float
    initial_value: 0.0
    units: "Gyr"
    description: "Time of last minor merger"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "transform_output_TimeOfLastMinorMerger"
    
  # Feedback
  - name: OutflowRate
    type: float
    initial_value: 0.0
    units: "Msun/yr"
    description: "Outflow rate from feedback"
    output: true
    read_only: false
    is_core: false
    output_transformer_function: "transform_output_OutflowRate"
    
  - name: TotalSatelliteBaryons
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Total baryon mass in satellites"
    output: true
    read_only: false
    is_core: false
    
  # Special derived outputs - dynamically calculated at output time
  # These don't need to be stored in the galaxy structure, only calculated for output
  - name: SfrDiskZ
    type: float
    initial_value: 0.0
    units: "dimensionless"
    description: "Gas-phase metallicity during disk star formation"
    output: true
    read_only: true
    is_core: false
    output_transformer_function: "derive_output_SfrDiskZ"
    
  - name: SfrBulgeZ
    type: float
    initial_value: 0.0
    units: "dimensionless"
    description: "Gas-phase metallicity during bulge star formation"
    output: true
    read_only: true
    is_core: false
    output_transformer_function: "derive_output_SfrBulgeZ"
    
  # Infall Properties
  - name: infallMvir
    type: float
    initial_value: 0.0
    units: "1e10 Msun/h"
    description: "Virial mass at infall"
    output: true
    read_only: false
    is_core: true
    
  - name: infallVvir
    type: float
    initial_value: 0.0
    units: "km/s"
    description: "Virial velocity at infall"
    output: true
    read_only: false
    is_core: true
    
  - name: infallVmax
    type: float
    initial_value: 0.0
    units: "km/s"
    description: "Maximum circular velocity at infall"
    output: true
    read_only: false
    is_core: true